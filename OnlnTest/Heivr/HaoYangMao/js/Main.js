(function(){var i_InNodeJs=("undefined"==typeof self);var l_Glb=i_InNodeJs?global:self;l_Glb.nWse.stAsynIcld.cPreLoad("", ["Main.js"]);})();(function(){var A=nWse.stNumUtil,B=nWse.stStrUtil,C=nWse.stDomUtil,D=nWse.stCssUtil,E=nWse.tPntIptTrkr.tPntIpt,F=E.tKind;function G(A){A.cStop().cPlay()}nWse.stPageInit.cAddEvtHdlr_DocRdy(function(){var I="getElementById",J="e_GlbSclDiv",K="i_DsnWid",L="i_DsnHgt",M="cOnWndRsz",N="e_SheepDiv",O="eRsetSheepParts";var B;(function(){B=function(){};nApp.stApp=B;B.oc_nHost=nApp;B.oc_FullName=nApp.ocBldFullName("stApp");B.ocBldFullName=function(A){return B.oc_FullName+"."+A};B.e_AudSupt=true;B.e_CntDn=0;B.e_PlayDur=10;B.e_GameOver=false;B.e_RmnForSad=6;B.e_RmnForCry=2;B.e_FurAnmtDur=0.3;B.e_SheepJumpAnmtDur=0.5;B.e_SheepJumpAmp=40;B.e_WordsTot=8;B.e_RandWordsAmt=3})();B.c_PrstTgt=document[I]("k_PrstTgt");nWse.fEnum(B,function tGameSta(){},null,"i_Init","i_Run","i_Cplt");B.e_GameSta=B.tGameSta.i_Init;var E=2;B[J]=document[I]("k_GlbSclDiv");B[K]=B[J].offsetWidth;B[L]=B[J].offsetHeight;console.log("设计宽高 = "+B[K]+", "+B[L]);nWse.stCssUtil.cSetDim(B[J],Math.round(B[K]/E),Math.round(B[L]/E));B.eUpdGlbScl=function(){var A=nWse.stDomUtil.cGetVwptWid()*E/B.i_DsnWid,C=nWse.stDomUtil.cGetVwptHgt()*E/B.i_DsnHgt;B.i_GlbSclX=A;B.i_GlbSclY=C;console.log("全局缩放 = "+A+", "+C);var D;D=nWse.stCssUtil.cAcsExtdAnmt_2dTsfm(B.e_GlbSclDiv);D.c_Scl.x=A;D.c_Scl.y=C;nWse.stCssUtil.cUpdExtdAnmt_2dTsfm(B.e_GlbSclDiv)};B[M]=function(){B.eUpdGlbScl();if(B.e_SheepDiv){nWse.stCssUtil.cFnshAnmt(B.e_SheepDiv,true,true)}};B[M]();C.cAddEvtHdlr(window,"resize",nWse.stFctnUtil.cBindThis(B,B[M]));B.cInit=function(){var C="e_RandWordsAmt",D="e_RandWordsNums";var A=this;A.e_PIT=new nWse.tPntIptTrkr();A.e_PIT.cInit({c_HdlMode:1});A.e_PIT.cSetImdtHdlr(nWse.stFctnUtil.cBindThis(A,A.eHdlIpt));B.eCntDn();nWse.stDfrdLoad.cAsnSrcPpty("[data-wse_src]");if(B.e_WordsTot>0){B.e_WrodsImg=document.getElementById("k_WordsImg");B[D]=H(null,B[C],1,B.e_WordsTot);B.e_RandWordsImgs=new Array(B[C]);nWse.stAryUtil.cFor(B[D],function(A,C,D){var E=new Image();E.src="./media/Words/"+D+".png";B.e_RandWordsImgs[C]=E})}if(B.e_AudSupt){B.eLoadAud()}};B.eLoadAud=function(){if(!B.e_AudSupt){return}B.e_Mp3_Baa=new nWse.nAud.tAudRsrc();B.e_Mp3_Baa.cLoadFromUrl("./media/Baa.mp3");B.e_Mp3_Coin=new nWse.nAud.tAudRsrc();B.e_Mp3_Coin.cLoadFromUrl("./media/Coin.mp3")};function H(A,B,C,D){if(!A){A=[]}var E=D-C+1;if(B>E){throw new Error("a_Amt大于(a_Max - a_Min + 1)！")}var i,n,F=0;for(i=0;i<B;++i){do{n=nWse.stNumUtil.cRandInt(C,D);++F}while((A.indexOf(n)>=0)&&(F<100));A.push(n)}return A}B.eObtnScrn=function(A){return C.cQryOne(".mi_scrn.mi_"+A)};B.eShowHideScrnBySta=function(A,C){var D=A.toString();D=D.slice(2,D.length);var E=B.eObtnScrn(D);E.style.display=C?"block":"none"};nWse.fEnum(B,function tFurSta(){},null,"i_Atch","i_Fly","i_Dspr");B[N]=document[I]("k_SheepDiv");B[N].style.width="auto";B.eObtnScrn("Init").appendChild(B[N]);B.e_SheepDivOrigY=B[N].offsetTop;B.e_SheepShdwDiv=document[I]("k_SheepShdwDiv");B.eSheepPutCen=function(){nWse.stCssUtil.cSetPos(B.e_SheepDiv,(B.i_DsnWid/E-B.e_SheepDiv.offsetWidth)/2,B.e_SheepDivOrigY)};B.eSheepPutCen();B.e_SheepBody=document[I]("k_SheepBody");B.e_SheepHeads=nWse.stDomUtil.cQryAll(".mi_head");B.e_SheepFurs=nWse.stDomUtil.cQryAll(".mi_fur");nWse.stAryUtil.cFor(B.e_SheepFurs,function(A,C,D){var E="App_Data";D[E]={};D[E].App_Sta=B.tFurSta.i_Atch;D[E].App_X=parseFloat(D.getAttribute("data-x"))/2;D[E].App_Y=parseFloat(D.getAttribute("data-y"))/2;D.style.zIndex=(A.length-C)+20});B.eShowSheepHeadByCssc=function(A){nWse.stAryUtil.cFor(B.e_SheepHeads,function(B,C,D){if(nWse.stCssUtil.cHasCssc(D,A)){D.style.display="block"}else{D.style.display="none"}})};B.eGetAtchFurAmt=function(){var A=0;nWse.stAryUtil.cFor(B.e_SheepFurs,function(C,D,E){if(E.App_Data.App_Sta==B.tFurSta.i_Atch){++A}});return A};B[O]=function(){B.eShowSheepHeadByCssc("mi_head_smile");nWse.stAryUtil.cFor(B.e_SheepFurs,function(A,C,D){var E="App_Data";nWse.stCssUtil.cFnshAnmt(D,true,true);D.style.position="absolute";D.style.display="block";nWse.stCssUtil.cSetPos(D,D[E].App_X,D[E].App_Y);D[E].App_Sta=B.tFurSta.i_Atch})};B[O]();B.e_CoinCnt=0;B.e_CoinCntrDiv=document[I]("k_CoinCntrDiv");B.e_CoinCntr=document[I]("k_CoinCntr");B.eCntDn=function(){function A(){B.eShowHideScrnBySta(B.e_GameSta,false);B.eSttGame()}var B=this;if(B.e_CntDn<=0){A();return}B.e_CntDnNum=document.getElementById("k_CntDnNum");D.cAddCssc(B.e_CntDnNum,("mi_"+B.e_CntDn));function C(){var E="e_CntDn";if(B[E]>0){--B[E]}if(B[E]<=0){A()}else{D.cRmvCssc(B.e_CntDnNum,("mi_"+(B[E]+1)));D.cAddCssc(B.e_CntDnNum,("mi_"+B[E]));window.setTimeout(C,1000)}}window.setTimeout(C,1000)};B.eTsitStaToCplt=function(){var C="eShowHideScrnBySta",D="e_GameSta";var A=this;A[C](A[D],false);A[D]=B.tGameSta.i_Cplt;A[C](A[D],true);A.eObtnScrn("Cplt").appendChild(B.e_CoinCntrDiv);A.e_AcpPrz=document.getElementById("k_AcpPrz")};B.eSttGame=function(){var A=this;A.e_GameSta=B.tGameSta.i_Run;A.eShowHideScrnBySta(A.e_GameSta,true);A.eTsitSta_RunEnt();if(A.eIsGameTimeUp()){A.eTsitStaToCplt()}};B.eTsitSta_RunEnt=function(){var E="e_TimeLine_TensPlc",F="e_TimeLine_OnesPlc";var A=this;B.eObtnScrn("Run").appendChild(B.e_SheepDiv);A.e_PlayTmr=A.e_PlayDur;if(A.eIsGameTimeUp()){return}A[E]=document[I]("k_TimeLine_TensPlc");A[F]=document[I]("k_TimeLine_OnesPlc");A.e_TimePgrs=document[I]("k_TimePgrs");A.e_TimeSph=document[I]("k_TimeSph");if(10!=A.e_PlayTmr){D.cRmvCssc(A[E],"mi_1");D.cRmvCssc(A[F],"mi_0");A.eUpdGameRunUi(true)}function C(){if(A.e_PlayTmr>0){--A.e_PlayTmr}A.eUpdGameRunUi(false);if(A.eIsGameTimeUp()){window.setTimeout(function(){if(B.e_GameOver){A.eTsitStaToCplt()}},1000)}else{window.setTimeout(C,1000)}}window.setTimeout(C,1000)};B.eRmvCssc_NumRge=function(A,B,C){var E,F;for(E=B;E<=C;++E){F="mi_"+E;if(D.cHasCssc(A,F)){D.cRmvCssc(A,F);break}}};B.eUpdGameRunUi=function(A){var L="eRmvCssc_NumRge",M="e_TimeLine_TensPlc",N="e_PlayTmr",O="cAddCssc",P="e_TimeLine_OnesPlc",Q="e_RandWordsAmt",R="e_PlayDur",S="e_RandWordsImgs",T="e_WrodsImg";var C=this;if(!A){B[L](C[M],0,9);B[L](C[P],0,9)}var E=0,F=0;if(C[N]>=10){E=Math.floor(C[N]/10);D[O](C[M],("mi_"+E))}else{E=0;if(!D.cHasCssc(C[M],("mi_0"))){D[O](C[M],("mi_0"))}}F=C[N]-E*10;D[O](C[P],("mi_"+F));var G=Math.round(C[N]/C[R]*100);C.e_TimePgrs.style.width=G+"%";if(C.eIsGameTimeUp()){D[O](C.e_TimeSph,"mi_emt")}var H,I,J,K;if(B[Q]>0){H=Math.round((B[R]-1)/B[Q]);I=Math.floor((B[R]-1-C[N])/H);if((I<B[S].length)&&(B[T].src!=B[S][I].src)){B[T].src=B[S][I].src;J=B.e_RandWordsNums[I];K=parseFloat(B[T].parentNode.getAttribute((J%2)?"data-odd_x":"data-even-x"));B[T].parentNode.style.left=K+"px"}}};B.eIsGameTimeUp=function(){return(this.e_PlayTmr<=0)};B.eHdlIpt=function(A){var C=this,D=A.c_Tchs[0],E=D.cAcsEvtTgt();if(B.tGameSta.i_Run==C.e_GameSta){C.eHdlIpt_StaRun(A)}else if(B.tGameSta.i_Cplt==C.e_GameSta){C.eHdlIpt_StaCplt(A)}nWse.stAryUtil.cFor(A.c_Tchs,function(A,B,C){C.c_Hdld=true});return false};B.eHdlIpt_StaRun=function(A){var C=this,D=A.c_Tchs;nWse.stAryUtil.cFor(D,function(A,D,E){if(F.i_TchBgn!=E.c_Kind){return}var G=E.cAcsEvtTgt(),H=C.e_SheepFurs.indexOf(G);if(H>=0){B.eHdlIpt_Fur(H)}})};B.eHdlIpt_Fur=function(C){var H="e_CoinCnt",I="eShowSheepHeadByCssc";var D=this,E=D.e_SheepFurs[C];if(E.App_Data.App_Sta!=B.tFurSta.i_Atch){return}++B[H];nWse.stDomUtil.cSetTextCtnt(B.e_CoinCntr,(((B[H]<10)?"0":"")+B[H].toString()));E.App_Data.App_Sta=B.tFurSta.i_Fly;nWse.stCssUtil.cAnmt(E,{"opacity":0},{c_Dur:B.e_FurAnmtDur,c_fEsn:A.cEsn_FastToSlow,c_fOnEnd:function(A){A.style.display="none";A.style.opacity="1";A.App_Data.App_Sta=B.tFurSta.i_Dspr}});var F=B.eGetAtchFurAmt();if(F<=B.e_RmnForCry){B[I]("mi_head_cry");if(F==B.e_RmnForCry){G(B.e_Mp3_Baa)}}else if(F<=B.e_RmnForSad){B[I]("mi_head_sad");if(F==B.e_RmnForSad){G(B.e_Mp3_Baa)}}G(B.e_Mp3_Coin);if(0==F){D.eChgSheep()}};B.eChgSheep=function(){var A=this,C=B.e_SheepJumpAnmtDur;function D(A,D,E,F,G,H,I,J,K){var L=Math.PI/C*2,M=-B.e_SheepJumpAmp*Math.abs(Math.sin(L*I));A.y+=M}nWse.stCssUtil.cAnmt(A.e_SheepDiv,{"left":(-A.e_SheepDiv.offsetWidth)+"px"},{c_Dur:C,c_fDplc:D,c_fOnEnd:F});B.e_SheepShdwDiv.style.visibility="hidden";function F(){A.eRsetSheepParts();nWse.stCssUtil.cSetPos(A[N],B.i_DsnWid/E,B.e_SheepDivOrigY);var F=(B.i_DsnWid/E-B[N].offsetWidth)/2;nWse.stCssUtil.cAnmt(A[N],{"left":(F)+"px"},{c_Dur:C,c_fDplc:D,c_fOnEnd:function(){B.eSheepPutCen();B.e_SheepShdwDiv.style.visibility="visible"}})}};B.eHdlIpt_StaCplt=function(A){var B=this,D=A.c_Tchs[0],E=D.cAcsEvtTgt();if(F.i_TchBgn!=D.c_Kind){return false}if(B.e_AcpPrz&&C.cIsSelfOrAcst(B.e_AcpPrz,E)){console.log("去领红包！")}}});nWse.stPageInit.cAddEvtHdlr_WndLoad(function(){console.log("window.onload");nApp.stApp.cInit()})})();