(function(){var i_InNodeJs=("undefined"==typeof self);var l_Glb=i_InNodeJs?global:self;l_Glb.nWse.stAsynIcld.cPreLoad("", ["Main.js"]);})();(function(){var A=nWse.stNumUtil,B=nWse.stStrUtil,C=nWse.stDomUtil,D=nWse.stCssUtil,E=nWse.tPntIptTrkr.tPntIpt,F=E.tKind;function G(A){A.cStop().cPlay()}nWse.stPageInit.cAddEvtHdlr_DocRdy(function(){var H="getElementById",I="e_GlbSclDiv",J="i_DsnWid",K="i_DsnHgt",L="cOnWndRsz",M="e_SheepDiv",N="eRsetSheepParts";var A;(function(){A=function(){};nApp.stApp=A;A.oc_nHost=nApp;A.oc_FullName=nApp.ocBldFullName("stApp");A.ocBldFullName=function(B){return A.oc_FullName+"."+B};A.e_AudSupt=true;A.e_CntDn=5;A.e_PlayDur=10;A.e_GameOver=true;A.e_RmnForSad=6;A.e_RmnForCry=2;A.e_FurAnmtDur=0.2;A.e_SheepJumpAnmtDur=0.5;A.e_SheepJumpAmp=40;A.e_WordsTot=8;A.e_RandWordsAmt=3})();A.c_PrstTgt=document[H]("k_PrstTgt");nWse.fEnum(A,function tGameSta(){},null,"i_Init","i_Run","i_Cplt");A.e_GameSta=A.tGameSta.i_Init;var B=2;A[I]=document[H]("k_GlbSclDiv");A[J]=A[I].offsetWidth;A[K]=A[I].offsetHeight;console.log("设计宽高 = "+A[J]+", "+A[K]);nWse.stCssUtil.cSetDim(A[I],Math.round(A[J]/B),Math.round(A[K]/B));A.eUpdGlbScl=function(){var C=nWse.stDomUtil.cGetVwptWid()*B/A.i_DsnWid,D=nWse.stDomUtil.cGetVwptHgt()*B/A.i_DsnHgt;A.i_GlbSclX=C;A.i_GlbSclY=D;console.log("全局缩放 = "+C+", "+D);var E;E=nWse.stCssUtil.cAcsExtdAnmt_2dTsfm(A.e_GlbSclDiv);E.c_Scl.x=C;E.c_Scl.y=D;nWse.stCssUtil.cUpdExtdAnmt_2dTsfm(A.e_GlbSclDiv)};A[L]=function(){A.eUpdGlbScl();if(A.e_SheepDiv){nWse.stCssUtil.cFnshAnmt(A.e_SheepDiv,true,true)}};A[L]();C.cAddEvtHdlr(window,"resize",nWse.stFctnUtil.cBindThis(A,A[L]));A.cInit=function(){var C="e_RandWordsAmt",D="e_RandWordsNums";var B=this;B.e_PIT=new nWse.tPntIptTrkr();B.e_PIT.cInit({c_HdlMode:1});B.e_PIT.cSetImdtHdlr(nWse.stFctnUtil.cBindThis(B,B.eHdlIpt));A.eCntDn();nWse.stDfrdLoad.cAsnSrcPpty("[data-wse_src]");if(A.e_WordsTot>0){A.e_WrodsImg=document.getElementById("k_WordsImg");A[D]=E(null,A[C],1,A.e_WordsTot);A.e_RandWordsImgs=new Array(A[C]);nWse.stAryUtil.cFor(A[D],function(B,C,D){var E=new Image();E.src="./media/Words/"+D+".png";A.e_RandWordsImgs[C]=E})}if(A.e_AudSupt){A.eLoadAud()}};A.eLoadAud=function(){if(!A.e_AudSupt){return}A.e_Mp3_Baa=new nWse.nAud.tAudRsrc();A.e_Mp3_Baa.cLoadFromUrl("./media/Baa.mp3");A.e_Mp3_Coin=new nWse.nAud.tAudRsrc();A.e_Mp3_Coin.cLoadFromUrl("./media/Coin.mp3")};function E(A,B,C,D){if(!A){A=[]}var E=D-C+1;if(B>E){throw new Error("a_Amt大于(a_Max - a_Min + 1)！")}var i,n,F=0;for(i=0;i<B;++i){do{n=nWse.stNumUtil.cRandInt(C,D);++F}while((A.indexOf(n)>=0)&&(F<100));A.push(n)}return A}A.eObtnScrn=function(A){return C.cQryOne(".mi_scrn.mi_"+A)};A.eShowHideScrnBySta=function(B,C){var D=B.toString();D=D.slice(2,D.length);var E=A.eObtnScrn(D);E.style.display=C?"block":"none"};nWse.fEnum(A,function tFurSta(){},null,"i_Atch","i_Fly","i_Dspr");A[M]=document[H]("k_SheepDiv");A[M].style.width="auto";A.eObtnScrn("Init").appendChild(A[M]);A.e_SheepDivOrigY=A[M].offsetTop;A.e_SheepShdwDiv=document[H]("k_SheepShdwDiv");A.eSheepPutCen=function(){nWse.stCssUtil.cSetPos(A.e_SheepDiv,(A.i_DsnWid/B-A.e_SheepDiv.offsetWidth)/2,A.e_SheepDivOrigY)};A.eSheepPutCen();A.e_SheepBody=document[H]("k_SheepBody");A.e_SheepHeads=nWse.stDomUtil.cQryAll(".mi_head");A.e_SheepFurs=nWse.stDomUtil.cQryAll(".mi_fur");nWse.stAryUtil.cFor(A.e_SheepFurs,function(B,C,D){var E="App_Data";D[E]={};D[E].App_Sta=A.tFurSta.i_Atch;D[E].App_X=parseFloat(D.getAttribute("data-x"))/2;D[E].App_Y=parseFloat(D.getAttribute("data-y"))/2;D.style.zIndex=(B.length-C)+20});A.eShowSheepHeadByCssc=function(B){nWse.stAryUtil.cFor(A.e_SheepHeads,function(A,C,D){if(nWse.stCssUtil.cHasCssc(D,B)){D.style.display="block"}else{D.style.display="none"}})};A.eGetAtchFurAmt=function(){var B=0;nWse.stAryUtil.cFor(A.e_SheepFurs,function(C,D,E){if(E.App_Data.App_Sta==A.tFurSta.i_Atch){++B}});return B};A[N]=function(){A.eShowSheepHeadByCssc("mi_head_smile");nWse.stAryUtil.cFor(A.e_SheepFurs,function(B,C,D){var E="App_Data";nWse.stCssUtil.cFnshAnmt(D,true,true);D.style.position="absolute";D.style.display="block";nWse.stCssUtil.cSetPos(D,D[E].App_X,D[E].App_Y);D[E].App_Sta=A.tFurSta.i_Atch})};A[N]();A.e_CoinCnt=0;A.e_CoinCntrDiv=document[H]("k_CoinCntrDiv");A.e_CoinCntr=document[H]("k_CoinCntr");A.eCntDn=function(){function A(){B.eShowHideScrnBySta(B.e_GameSta,false);B.eSttGame()}var B=this;if(B.e_CntDn<=0){A();return}B.e_CntDnNum=document.getElementById("k_CntDnNum");D.cAddCssc(B.e_CntDnNum,("mi_"+B.e_CntDn));function C(){var E="e_CntDn";if(B[E]>0){--B[E]}if(B[E]<=0){A()}else{D.cRmvCssc(B.e_CntDnNum,("mi_"+(B[E]+1)));D.cAddCssc(B.e_CntDnNum,("mi_"+B[E]));window.setTimeout(C,1000)}}window.setTimeout(C,1000)};A.eTsitStaToCplt=function(){var C="eShowHideScrnBySta",D="e_GameSta";var B=this;B[C](B[D],false);B[D]=A.tGameSta.i_Cplt;B[C](B[D],true);B.eObtnScrn("Cplt").appendChild(A.e_CoinCntrDiv);B.e_AcpPrz=document.getElementById("k_AcpPrz")};A.eSttGame=function(){var B=this;B.e_GameSta=A.tGameSta.i_Run;B.eShowHideScrnBySta(B.e_GameSta,true);B.eTsitSta_RunEnt();if(B.eIsGameTimeUp()){B.eTsitStaToCplt()}};A.eTsitSta_RunEnt=function(){var E="e_TimeLine_TensPlc",F="e_TimeLine_OnesPlc";var B=this;A.eObtnScrn("Run").appendChild(A.e_SheepDiv);B.e_PlayTmr=B.e_PlayDur;if(B.eIsGameTimeUp()){return}B[E]=document[H]("k_TimeLine_TensPlc");B[F]=document[H]("k_TimeLine_OnesPlc");B.e_TimePgrs=document[H]("k_TimePgrs");B.e_TimeSph=document[H]("k_TimeSph");if(10!=B.e_PlayTmr){D.cRmvCssc(B[E],"mi_1");D.cRmvCssc(B[F],"mi_0");B.eUpdGameRunUi(true)}function C(){if(B.e_PlayTmr>0){--B.e_PlayTmr}B.eUpdGameRunUi(false);if(B.eIsGameTimeUp()){window.setTimeout(function(){if(A.e_GameOver){B.eTsitStaToCplt()}},1000)}else{window.setTimeout(C,1000)}}window.setTimeout(C,1000)};A.eRmvCssc_NumRge=function(A,B,C){var E,F;for(E=B;E<=C;++E){F="mi_"+E;if(D.cHasCssc(A,F)){D.cRmvCssc(A,F);break}}};A.eUpdGameRunUi=function(B){var L="eRmvCssc_NumRge",M="e_TimeLine_TensPlc",N="e_PlayTmr",O="cAddCssc",P="e_TimeLine_OnesPlc",Q="e_RandWordsAmt",R="e_PlayDur",S="e_RandWordsImgs",T="e_WrodsImg";var C=this;if(!B){A[L](C[M],0,9);A[L](C[P],0,9)}var E=0,F=0;if(C[N]>=10){E=Math.floor(C[N]/10);D[O](C[M],("mi_"+E))}else{E=0;if(!D.cHasCssc(C[M],("mi_0"))){D[O](C[M],("mi_0"))}}F=C[N]-E*10;D[O](C[P],("mi_"+F));var G=Math.round(C[N]/C[R]*100);C.e_TimePgrs.style.width=G+"%";if(C.eIsGameTimeUp()){D[O](C.e_TimeSph,"mi_emt")}var H,I,J,K;if(A[Q]>0){H=Math.round((A[R]-1)/A[Q]);I=Math.floor((A[R]-1-C[N])/H);if((I<A[S].length)&&(A[T].src!=A[S][I].src)){A[T].src=A[S][I].src;J=A.e_RandWordsNums[I];K=parseFloat(A[T].parentNode.getAttribute((J%2)?"data-odd_x":"data-even-x"));A[T].parentNode.style.left=K+"px"}}};A.eIsGameTimeUp=function(){return(this.e_PlayTmr<=0)};A.eHdlIpt=function(B){var C=this,D=B.c_Tchs[0],E=D.cAcsEvtTgt();if(A.tGameSta.i_Run==C.e_GameSta){C.eHdlIpt_StaRun(B)}else if(A.tGameSta.i_Cplt==C.e_GameSta){C.eHdlIpt_StaCplt(B)}nWse.stAryUtil.cFor(B.c_Tchs,function(A,B,C){C.c_Hdld=true});return false};A.eHdlIpt_StaRun=function(B){var C=this,D=B.c_Tchs;nWse.stAryUtil.cFor(D,function(B,D,E){if(F.i_TchBgn!=E.c_Kind){return}var G=E.cAcsEvtTgt(),H=C.e_SheepFurs.indexOf(G);if(H>=0){A.eHdlIpt_Fur(H)}})};A.eHdlIpt_Fur=function(B){var F="e_CoinCnt",H="eShowSheepHeadByCssc";var C=this,D=C.e_SheepFurs[B];if(D.App_Data.App_Sta!=A.tFurSta.i_Atch){return}++A[F];nWse.stDomUtil.cSetTextCtnt(A.e_CoinCntr,(((A[F]<10)?"0":"")+A[F].toString()));D.App_Data.App_Sta=A.tFurSta.i_Fly;nWse.stCssUtil.cAnmt(D,{"opacity":0},{c_Dur:A.e_FurAnmtDur,c_fOnEnd:function(B){B.style.display="none";B.style.opacity="1";B.App_Data.App_Sta=A.tFurSta.i_Dspr}});var E=A.eGetAtchFurAmt();if(E<=A.e_RmnForCry){A[H]("mi_head_cry");if(E==A.e_RmnForCry){G(A.e_Mp3_Baa)}}else if(E<=A.e_RmnForSad){A[H]("mi_head_sad");if(E==A.e_RmnForSad){G(A.e_Mp3_Baa)}}G(A.e_Mp3_Coin);if(0==E){C.eChgSheep()}};A.eChgSheep=function(){var C=this,D=A.e_SheepJumpAnmtDur;function E(B,C,E,F,G,H,I,J,K){var L=Math.PI/D*2,M=-A.e_SheepJumpAmp*Math.abs(Math.sin(L*I));B.y+=M}nWse.stCssUtil.cAnmt(C.e_SheepDiv,{"left":(-C.e_SheepDiv.offsetWidth)+"px"},{c_Dur:D,c_fDplc:E,c_fOnEnd:F});A.e_SheepShdwDiv.style.visibility="hidden";function F(){C.eRsetSheepParts();nWse.stCssUtil.cSetPos(C[M],A.i_DsnWid/B,A.e_SheepDivOrigY);var F=(A.i_DsnWid/B-A[M].offsetWidth)/2;nWse.stCssUtil.cAnmt(C[M],{"left":(F)+"px"},{c_Dur:D,c_fDplc:E,c_fOnEnd:function(){A.eSheepPutCen();A.e_SheepShdwDiv.style.visibility="visible"}})}};A.eHdlIpt_StaCplt=function(A){var B=this,D=A.c_Tchs[0],E=D.cAcsEvtTgt();if(F.i_TchBgn!=D.c_Kind){return false}if(B.e_AcpPrz&&C.cIsSelfOrAcst(B.e_AcpPrz,E)){console.log("去领红包！")}}});nWse.stPageInit.cAddEvtHdlr_WndLoad(function(){console.log("window.onload");nApp.stApp.cInit()})})();